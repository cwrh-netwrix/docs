---
description: >-
  This article provides detailed instructions on configuring templates for File Integrity Monitoring (FIM) using Agentless operation for legacy platforms.
keywords:
  - File Integrity Monitoring
  - Agentless operation
  - Netwrix Proxy Agent
sidebar_label: Gen 7 FIM Configuration
tags: []
title: Gen 7 Settings Page - Configuration Templates - FIM: Agentless File Integrity for Legacy Platforms
knowledge_article_id: kA04u0000000JRdCAM
products:
  - activity-monitor
---

# Gen 7 Settings Page - Configuration Templates - FIM: Agentless File Integrity for Legacy Platforms

## Configuration Templates: FIM File Integrity for Legacy Platforms/Agentless Operation

Where it is desirable to not use a **Netwrix Agent**, or where the platform to be monitored does not currently have a **Netwrix Agent** available (e.g., HP Non-Stop), **Netwrix** provides various Agentless FIM options. 

All Agentless monitoring is performed via a **Master Proxy Agent** – the Proxy function is supported by any **Netwrix Gen 7 Agent** and the dedicated **Netwrix Agent App Proxy Agent**.

![Architecture Diagram](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK4w&d=%2Fa%2F4u000000LzT5%2FCLcZ0W0z1ssARzRucLo9xvRx2Cy_i.H2axwXQMr0un0&asPdf=false)

The architecture of the solution is based around Proxy Agent instances as in the diagram above. The solution components are as follows:

### Proxy Agent

By default, every **Gen 7 Hub** server installation includes a **Netwrix Proxy Agent App** or, in later deployments, a **Netwrix Gen 7 Agent**. Additional Proxy Agent elements can be deployed to other devices to provide a distributed monitoring capability, which is useful in both reducing monitoring-traffic network loads and simplifying firewall rules where the devices being monitored are remote to the **Netwrix Gen 7 Hub**. Any single Proxy Agent instance can monitor hundreds of devices.

### Proxied Device

Once a Proxy Agent element has been established, the devices to be monitored can be configured. 

![Proxied Device Configuration](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK51&d=%2Fa%2F4u000000LzTB%2FBFkk6ZHPyd0.yBnT7imf6G3nZIQcN9OeC3sLcho.zq8&asPdf=false)

![Proxied Device Setup](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK56&d=%2Fa%2F4u000000LzTF%2Fw_YxYsnCvKKcI0enA7opFRPW.rRNiqGDkWpRIezP4Is&asPdf=false)

Adding a new Proxied Device requires the details opposite to be provided. Once the Names/Alias, IP Address/DNS Name of the device have been provided, the key element is the **Credentials** to be used. This defines aspects such as the protocol/terminal type to be used, username/password, and any login script/shell navigation.

### Credentials

> **Note:** For most scenarios, use the built-in **Credentials Scripts** accessible via the drop-down menu at the top of the **Add Shell Credential**.

![Add Shell Credential](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK5B&d=%2Fa%2F4u000000LzXk%2FoGF_l77GItlP.qPxkA_p_Ug5sxPU0CSGpTDxGPqpamY&asPdf=false)

The fields highlighted must always be filled – hit **Update** in the bottom right-hand corner of the window when finished. In the **Advanced Options**, there will be a definition of the path and name of the **Netwrix File Hash** binary being used. For high-security situations where it is desirable to maintain a 100% guarantee of a file's integrity, the **Change Tracker Netwrix File hash** binary is used. This is an extra command for the system that generates a hash value for all files serving as an infallible verification of file makeup. In addition, all file attributes will be tracked too.

### Netwrix Filehash

You can select the required **Netwrix Filehash** binary for the platform to be monitored from **Settings** → **System Settings** → **Advanced Options**. The file should be placed on the host with appropriate execute permissions.

![Netwrix Filehash Selection](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK5G&d=%2Fa%2F4u000000LzXp%2F3jvpCG1M0hjsDrKMQE8ZUPmo4D6vp6ird.2ZIcsHnWk&asPdf=false)

### Completion

At this stage, the Proxied Device has been added to your **Gen 7** system with the correct **Credentials** and a **Logon Script** assigned to it. The **Netwrix Filehash** has been copied to the host to be monitored and has been tested working.

At this point, you can then treat the Proxied Device in exactly the same way as an Agent-Based Device. Assigning the Proxied Device to a Group will apply a **Configuration Template** to the device together with any **Compliance Reports** for the Group, and any events and alerts will be displayed and handled in the same way as for any Agent-Based Device.

![Proxied Device Group Assignment](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdJnY&d=%2Fa%2F4u000000LzWx%2FTC7Mw91a9C4ecfhi3u556umNE0a_r9HoD_Mf1bp.NHQ&asPdf=false)

## Additional Troubleshooting Notes on Using Netwrix Filehash

You can verify if the **Netwrix Filehash** is operational by logging onto the system to be monitored and entering the command `NNT_Filehash_xxxx` (where xxxx is the suffix for your chosen **Netwrix Filehash** binary, e.g., `NNT_FILEHASH_LINUX_x64`). Here, the **NNT_Filehash** has been correctly copied to a valid executable path for the host and has been provided with the correct execute attributes for the user account being used.

![Verify Netwrix Filehash](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK1y&d=%2Fa%2F4u000000LzXu%2FR_Xb.R.18OD7eZrZVP3VhfTWnfhkEnE3u7ryMyuFHcM&asPdf=false)

### Common Agentless FIM Troubleshooting Tips:

- **'Permission denied'**: Check file permissions, especially execute permissions for the user account to be used by the **Change Tracker Proxy Agent**.

![Permission Denied Error](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK5L&d=%2Fa%2F4u000000LzXz%2Fuoh35Ue06Sl6.SbtJioNqBQqoOXO1e54hnatceuPQnw&asPdf=false)

- **'No such file or directory'**: Check that the **NNT_Filehash** has been placed on a path for the user account being used. Use `$PATH` to show the path variable settings for the user account. You can modify the user path by creating a custom `.sh` shell script in `/etc/profile.d/` or by modifying `/etc/bashrc` or `/etc/profile`, but reference the appropriate guidance for your platform OS.

![No Such File Error](https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&ids=0684u00000LdK5Q&d=%2Fa%2F4u000000LzY4%2FXKFpR1xqOd5xLxFcguczjByk_jJsKPiLzbHvdizqS_Q&asPdf=false)

- **'error while loading shared libraries'**: Suggests there may be missing dependencies or required libraries are not on an executable path for the user account being used. 

Check dependencies of **Netwrix Filehash** using `ldd NNT_FILEHASH_LINUX_X64`. Here, the `libstdc++.so.6` file is reported as 'not found', while all other dependencies have been located OK.

Check if `libstdc++.*` is present on the platform to be monitored using the command `find / -name libstdc++.*`. If the file is located, then it will be necessary to either copy the file to the standard default path, e.g., `/usr/bin`, or at least create a link from the path to the file. 

If the `libstdc++` file is not located on this host, please run the find command on any other similar servers, especially any with compiler capabilities. If located, please take a copy of the file, move it to all other servers, and place it on the `/usr/bin` path. 

If `libstdc++` does not exist anywhere within your server estate, then it will be necessary to get the binary from the Manufacturer repository or contact support@nntws.com.